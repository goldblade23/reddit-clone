<a href="/">home</a>
{% if request.user.is_authenticated %}
<a href="/logout/">logout</a>
<p>Hello, {{request.user.username}}!</p>
{% else %}
<a href="/login/">login</a>
<a href="/signup/">signup</a>
{% endif %}

<hr>

{% if request.user.is_authenticated %}
<a href="/createcommunity/">create new community</a>
<p>create new post</p>
<a href="/r/{{post.community.name}}/addtextpost">text</a>
or
<a href="/r/{{post.community.name}}/addlinkpost">link</a>
{% else %}
<a href="/login/">create new community</a>
{% endif %}

<hr>


    <h2>{{post.title}}</h2>
    <p>posted at <a href="/r/{{post.community.name}}">r/{{post.community.name}}</a></p>
    <p>{{post.text}}</p>
    <a href='{{post.urls}}'>{{post.urls}}</a>
    <p>{{post.date}}</p>
    <p>likes: {{post.post_likes_count}}</p>
    <p><a href='/r/{{post.community.name}}/post/{{post.id}}'>comments {{post.get_comment_count}}</a></p>
    
    {% if reddituser in post.post_likes.all %}
        <a href='postvote/unlike/{{post.id}}'>unlike</a>
        <a href='postvote/dislike/{{post.id}}'>dislike</a>
    {% elif reddituser in post.post_dislikes.all %}
        <a href='postvote/like/{{post.id}}'>like</a>
        <a href='postvote/undislike/{{post.id}}'>undislike</a>
    {% else %}
        <a href='postvote/like/{{post.id}}'>like</a>
        <a href='postvote/dislike/{{post.id}}'>dislike</a>
    {% endif %}


    <hr>
    <form action="" method="post">
        {% csrf_token %}
        {{ form }}
        <input type="submit" value="Submit">
    </form>
    
    <hr>

    {% load mptt_tags %}
<ul>
    {% recursetree comments %}
        <div id=c-{{node.id}}>
        <li>
            <p>{{ node.commenter.displayname }}</p>
            <b>{{ node.text }}</b>
            <p>{{ node.date }}</p>
            <p>{{ node.comment_likes_count }}</p>
            {% if reddituser in node.comment_likes.all %}
                <a href='commentvote/unlike/{{node.id}}'>unlike</a>
                <a href='commentvote/dislike/{{node.id}}'>dislike</a>
            {% elif reddituser in node.comment_dislikes.all %}
                <a href='commentvote/like/{{node.id}}'>like</a>
                <a href='commentvote/undislike/{{node.id}}'>undislike</a>
            {% else %}
                <a href='commentvote/like/{{node.id}}'>like</a>
                <a href='commentvote/dislike/{{node.id}}'>dislike</a>
            {% endif %}


            <form action="" method="post">
                {% csrf_token %}
                {{ form }}
                <input type="hidden" name="comment_id" value="{{ node.id }}">
                <input type="submit" value="Submit">
            </form>



            {% if not node.is_leaf_node %}
                <ul class="children">
                    {{ children }}
                </ul>
            {% endif %}
        </li>
    </div>
    {% endrecursetree %}
</ul>
